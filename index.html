<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,maximum-scale=1,user-scalable=no">
<title>HUB DUAL â€” Compact Family</title>
<meta name="theme-color" content="#0b0b14">
<style>
  /* â€”â€”â€” Base familyâ€‘friendly + compact â€”â€”â€” */
  :root{
    --grad-a:#b7b5ff; /* tons mais suaves */
    --grad-b:#8be5ff;
    --fg:#10131a;      /* texto mais escuro para acessibilidade */
    --mut:rgba(16,19,26,.6);
    --surface:rgba(255,255,255,.75);
    --surface-strong:rgba(255,255,255,.92);
    --bd:1px solid rgba(16,19,26,.08);
    --r:14px; --r-lg:16px;
    --shadow:0 6px 18px rgba(16,19,26,.12);
    --tabsH:64px;
    --acc:#5e74ff; --acc2:#47d1ff;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--fg);
    background:linear-gradient(38deg,var(--grad-a),var(--grad-b)) fixed;
    font:14px/1.35 "Inter", "SF Pro Rounded", system-ui, -apple-system, Segoe UI, Roboto, Arial;
    -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    overflow:hidden;
  }
  /* Header compacto */
  header.mast{position:fixed;z-index:100;top:env(safe-area-inset-top,0);left:0;right:0;height:64px;display:flex;align-items:center;gap:10px;padding:0 12px;backdrop-filter:blur(14px) saturate(130%)}
  .icon-btn{width:36px;height:36px;border-radius:10px;display:grid;place-items:center;background:var(--surface);border:var(--bd);box-shadow:var(--shadow);color:var(--fg);cursor:pointer}
  .icon-btn:active{transform:scale(.97)}
  .title-block{flex:1;text-align:center;line-height:1}
  .title-block h1{margin:0;font-size:18px;font-weight:900;letter-spacing:.04em}
  .title-block small{display:block;font-size:10px;color:var(--mut);letter-spacing:.08em}

  /* Brain dropdown clean */
  .brain-wrap{position:relative}
  .brain-menu{position:absolute;top:calc(100% + 4px);right:0;width:min(92vw,320px);padding:8px;background:var(--surface-strong);border:var(--bd);border-radius:var(--r-lg);box-shadow:var(--shadow);display:none;z-index:101}
  .brain-menu.open{display:block}
  .brain-menu h3{margin:2px 6px 6px;font-size:13px;font-weight:800;letter-spacing:.04em}
  .b-list{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:6px}
  .b-item{display:flex;align-items:center;gap:10px;padding:8px 10px;border-radius:12px;background:rgba(16,19,26,.04);border:var(--bd);cursor:pointer}
  .b-item:hover{background:rgba(16,19,26,.07)}
  .b-item svg{width:18px;height:18px}
  .b-item span{flex:1;font-weight:700;font-size:13px}
  .b-item small{font-size:11px;color:var(--mut)}

  /* Main */
  main{position:relative;height:100%;padding-top:calc(64px + env(safe-area-inset-top));padding-bottom:calc(var(--tabsH) + 8px + env(safe-area-inset-bottom));overflow:auto}
  .view{padding:10px 12px}

  /* Cards compactos */
  .cards{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  @media (max-width:520px){.cards{grid-template-columns:1fr}}
  .card{background:var(--surface);border:var(--bd);border-radius:var(--r);box-shadow:var(--shadow);padding:10px;min-height:72px;display:flex;gap:8px;align-items:center}
  .ico{width:40px;height:40px;border-radius:10px;display:grid;place-items:center;background:#fff;border:1px solid rgba(16,19,26,.08);color:#495266}
  .muted{color:var(--mut);font-size:12px}
  .btn{appearance:none;border:1px solid rgba(16,19,26,.12);border-radius:10px;background:#ffffff;box-shadow:var(--shadow);color:var(--fg);font-weight:800;padding:.5rem .7rem;cursor:pointer}
  .btn.prime{background:linear-gradient(90deg,var(--acc),var(--acc2));color:#0b0b14;border-color:transparent}
  .pill{font-size:10px;color:#4f65ff;letter-spacing:.04em}
  .input,textarea,select{width:100%;background:#fff;color:var(--fg);border:1px solid rgba(16,19,26,.12);border-radius:10px;padding:8px}

  /* Apps list */
  .apps-list .card .title{font-weight:800;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .apps-list .card .row{display:flex;gap:6px;flex-wrap:wrap}

  /* Stack (iframe) */
  .session{background:#ffffff;border:var(--bd);border-radius:12px;box-shadow:var(--shadow);overflow:hidden}
  .session .hdr{display:flex;align-items:center;gap:6px;padding:8px 8px;background:#f6f8ff;border-bottom:1px solid rgba(16,19,26,.08)}
  .session .title{font-weight:850;max-width:56vw;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .session .tools{margin-left:auto;display:flex;gap:4px}
  .session .tools .btn{width:34px;height:34px;padding:0;border-radius:10px;display:grid;place-items:center;background:#fff}
  .session iframe{display:block;width:100%;height:58vh;border:0;background:#000}
  .session.min iframe{display:none}
  .dock{position:fixed;left:10px;right:10px;bottom:calc(var(--tabsH) + 6px);display:flex;gap:6px;flex-wrap:wrap;z-index:70}
  .badge{display:inline-flex;gap:6px;align-items:center;padding:.3rem .55rem;border:1px solid rgba(16,19,26,.12);background:#fff;border-radius:999px;font-weight:800}

  /* Tabbar compacta */
  nav.tabbar{position:fixed;left:0;right:0;bottom:env(safe-area-inset-bottom,0);height:var(--tabsH);z-index:100;display:flex;justify-content:center;padding:6px 12px}
  .tabbar .inner{width:100%;max-width:520px;display:flex;justify-content:space-around;align-items:center;background:var(--surface);border:var(--bd);border-radius:var(--r-lg);box-shadow:var(--shadow);padding:8px}
  .tab{flex:1;display:flex;flex-direction:column;align-items:center;gap:2px;color:var(--mut);font-size:10px;font-weight:800;padding:6px;border-radius:10px;cursor:pointer}
  .tab.active{color:var(--fg);background:#fff;box-shadow:0 0 0 2px rgba(16,19,26,.06)}

  /* Helpers */
  html,body{overflow-x:hidden}
</style>
</head>
<body>
  <header class="mast">
    <button class="icon-btn" id="btnBack" title="Voltar" aria-label="Voltar">
      <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
    </button>
    <div class="title-block">
      <h1>HUB DUAL</h1>
      <small>UNO Â· DUAL Â· TRINITY</small>
    </div>
    <div class="brain-wrap">
      <button class="icon-btn" id="btnBrainDrop" aria-haspopup="true" aria-expanded="false" title="Brain">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21a8 8 0 1 0-16 0"/><circle cx="12" cy="7" r="4"/></svg>
      </button>
      <div class="brain-menu" id="brainMenu">
        <h3>Brain</h3>
        <ul class="b-list">
          <li class="b-item" onclick="openBrain(true)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 20v-8"/><path d="M18 20V4"/><path d="M6 20v-4"/></svg>
            <span>Dual Infodose</span><small>abrir painel</small>
          </li>
          <li class="b-item" onclick="setPerf('Low')">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3h18v4H3z"/><path d="M3 10h12v4H3z"/><path d="M3 17h6v4H3z"/></svg>
            <span>Performance</span><small id="perfSmall">Low</small>
          </li>
          <li class="b-item" onclick="ttsTest()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a4 4 0 0 1-4 4H7l-4 4V5a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z"/></svg>
            <span>TTS Voices</span><small>teste</small>
          </li>
          <li class="b-item" onclick="clearLogs()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"/><path d="M3 12h18"/><path d="M3 18h18"/></svg>
            <span>Logs</span><small>limpar</small>
          </li>
          <li class="b-item" onclick="exportBackup()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/></svg>
            <span>Download</span><small>backup</small>
          </li>
        </ul>
      </div>
    </div>
  </header>

  <main>
    <!-- HOME -->
    <section id="view-home" class="view">
      <div class="cards">
        <button class="card" data-open="apps">
          <div class="ico"><svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="2"/><rect x="14" y="3" width="7" height="7" rx="2"/><rect x="14" y="14" width="7" height="7" rx="2"/><rect x="3" y="14" width="7" height="7" rx="2"/></svg></div>
          <div><div style="font-weight:800">Apps</div><div class="muted">CatÃ¡logo (apps.json) + Locais</div></div>
        </button>
        <button class="card" data-open="stack">
          <div class="ico"><svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2l9 4.5-9 4.5L3 6.5 12 2z"/><path d="M3 13l9 4.5 9-4.5"/></svg></div>
          <div><div style="font-weight:800">Stack</div><div class="muted">SessÃµes abertas</div></div>
        </button>
        <button class="card" data-open="trinity">
          <div class="ico"><svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"/></svg></div>
          <div><div style="font-weight:800">Trinity</div><div class="muted">Viewer integrado</div></div>
        </button>
        <button class="card" data-open="brain">
          <div class="ico"><svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21a8 8 0 1 0-16 0"/><circle cx="12" cy="7" r="4"/></svg></div>
          <div><div style="font-weight:800">Dual Brain</div><div class="muted">Nome, SK, TTS</div></div>
        </button>
      </div>
    </section>

    <!-- APPS -->
    <section id="view-apps" class="view">
      <div class="card" style="width:100%">
        <div style="display:flex;gap:6px;align-items:center;flex-wrap:wrap;width:100%">
          <input id="appSearch" class="input" placeholder="Buscarâ€¦" style="max-width:320px">
          <select id="appSort" class="input" style="max-width:120px"><option value="az">Aâ€“Z</option><option value="za">Zâ€“A</option></select>
          <label class="pill"><input id="openInside" type="checkbox" checked> abrir dentro</label>
        </div>
        <div style="display:flex;gap:6px;align-items:center;flex-wrap:wrap;margin-top:6px;width:100%">
          <input id="fileLocal" type="file" accept=".html,.htm,.txt" multiple class="input">
          <button id="btnImportLocals" class="btn">+ Locais</button>
          <button id="btnExportLocals" class="btn">Exportar</button>
          <button id="btnClearLocals"  class="btn">Limpar</button>
          <div id="appsCount" class="pill" style="margin-left:auto">â€”</div>
        </div>
      </div>
      <div id="appsWrap" class="apps-list" style="display:grid;grid-template-columns:1fr;gap:8px"></div>
    </section>

    <!-- STACK -->
    <section id="view-stack" class="view">
      <div id="stackWrap" class="grid" style="display:flex;flex-direction:column;gap:10px"></div>
    </section>

    <!-- TRINITY -->
    <section id="view-trinity" class="view">
      <div class="card" style="display:flex;gap:8px;align-items:center">
        <div class="ico">â—Ž</div>
        <div style="flex:1">
          <div style="font-weight:800">Dual-App acoplado</div>
          <div class="muted">Abrir qualquer URL dentro do viewer</div>
          <div style="display:flex;gap:6px;align-items:center;margin-top:6px">
            <input id="trinityUrl" class="input" placeholder="./index.html ou /app.html">
            <button id="btnOpenTrinity" class="btn prime">Abrir</button>
          </div>
        </div>
      </div>
      <div class="card" id="trinityLog" style="font:12px/1.25 ui-monospace,Menlo,Consolas">â€”</div>
    </section>
  </main>

  <div id="dock" class="dock"></div>

  <nav class="tabbar">
    <div class="inner">
      <button class="tab active" data-nav="home" title="Home"><svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12l9-9 9 9"/><path d="M9 21V9h6v12"/></svg><span style="display:none">Home</span></button>
      <button class="tab" data-nav="apps" title="Apps"><svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="2"/><rect x="14" y="3" width="7" height="7" rx="2"/><rect x="14" y="14" width="7" height="7" rx="2"/><rect x="3" y="14" width="7" height="7" rx="2"/></svg><span style="display:none">Apps</span></button>
      <button class="tab" data-nav="stack" title="Stack"><svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2l9 4.5-9 4.5L3 6.5 12 2z"/><path d="M3 13l9 4.5 9-4.5"/></svg><span style="display:none">Stack</span></button>
      <button class="tab" data-nav="trinity" title="Trinity"><svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"/></svg><span style="display:none">Trinity</span></button>
    </div>
  </nav>

  <!-- Brain drawer mantÃ©m as funÃ§Ãµes, mas usarÃ¡ o mesmo JS do seu Hub unificado se colar abaixo. Para esta demo, colocamos utilidades mÃ­nimas -->
  <aside id="brain" aria-label="Dual Brain" style="position:fixed;right:0;top:0;bottom:0;width:360px;max-width:92vw;transform:translateX(105%);transition:transform .26s ease;background:var(--surface-strong);border-left:var(--bd);box-shadow:-10px 0 28px rgba(16,19,26,.18);padding:10px;z-index:120;border-top-left-radius:12px;border-bottom-left-radius:12px">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px"><div style="font-weight:800;letter-spacing:.04em">AETHER â€¢ BRAIN</div><button id="brainClose" class="btn">Fechar</button></div>
    <div class="card" style="display:block"><div class="pill">UsuÃ¡rio</div><div style="display:flex;gap:6px;align-items:center;margin-top:4px"><input id="userName" class="input" placeholder="Seu nome"><button id="saveName" class="btn prime">Salvar</button></div></div>
    <div class="card" style="display:block"><div class="pill">OpenRouter SK</div><div style="display:flex;gap:6px;align-items:center;margin-top:4px;flex-wrap:wrap"><input id="userSK" class="input" placeholder="sk-or-v1-â€¦"><button id="saveSK" class="btn prime">Salvar</button></div></div>
    <div class="card" style="display:block"><div class="pill">Logs</div><pre id="log" style="min-height:100px;font:12px/1.25 ui-monospace,Menlo,Consolas"></pre><button id="btnExportBrain" class="btn">Exportar Brain</button></div>
  </aside>

<script>
const $=(q,r=document)=>r.querySelector(q);const $$=(q,r=document)=>Array.from(r.querySelectorAll(q));
function navTo(key){ $$('.view').forEach(v=>v.style.display='none'); const v=$('#view-'+key); if(v) v.style.display='block'; $$('.tab').forEach(b=>b.classList.toggle('active', b.dataset.nav===key)); }
$$('[data-nav]').forEach(b=> b.addEventListener('click', ()=> navTo(b.dataset.nav)));
$$('[data-open]').forEach(c=> c.addEventListener('click', ()=> navTo(c.dataset.open==='brain'?'apps':c.dataset.open)));

// Brain dropdown
const brainMenu=$('#brainMenu'); $('#btnBrainDrop').onclick=(e)=>{ brainMenu.classList.toggle('open'); e.stopPropagation(); };
document.addEventListener('click', (e)=>{ if(!brainMenu.contains(e.target)) brainMenu.classList.remove('open'); });

// Drawer
function openBrain(on){ $('#brain').style.transform= on? 'translateX(0)': 'translateX(105%)'; }
$('#brainClose').onclick=()=> openBrain(false);

// Perf/TTS demo
function setPerf(p){ $('#perfSmall') && ($('#perfSmall').textContent=p); log('Perf='+p); }
function ttsTest(){ try{ if(!('speechSynthesis' in window)) return; const u=new SpeechSynthesisUtterance('Teste de voz'); u.lang='pt-BR'; speechSynthesis.cancel(); speechSynthesis.speak(u);}catch{} }

// Logs/backup demo
function log(m){ const box=$('#log'); if(!box) return; box.textContent=(new Date().toLocaleTimeString()+" â€¢ "+m+"\n")+box.textContent }
function exportBackup(){ const data={ when:Date.now(), storage:Object.assign({},localStorage) }; const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='dual.backup.json'; a.click(); }

// Apps (mÃ­nimo para listar locais)
const RAW={apps:[]}; function renderApps(list){ const wrap=$('#appsWrap'); wrap.innerHTML=''; const q=($('#appSearch')?.value||'').toLowerCase(); let L=(list||[]); if(q) L=L.filter(a=> (a.title||'').toLowerCase().includes(q)); L.forEach(a=>{ const el=document.createElement('div'); el.className='card'; el.innerHTML='<div class="ico">ðŸ§©</div><div><div class="title" style="font-weight:800">'+(a.title||'App')+'</div><div class="muted">'+(a.desc||'')+'</div><div style="margin-top:6px"><button class="btn">Abrir</button></div></div>'; wrap.appendChild(el); }); $('#appsCount').textContent=L.length+' apps'; }
renderApps(RAW.apps);

// Stack minimal
const stackWrap=$('#stackWrap'); const dock=$('#dock'); function updateDock(){ dock.innerHTML=''; $$('.session').forEach(s=>{ const meta=JSON.parse(s.dataset.meta||'{}'); const b=document.createElement('button'); b.className='badge'; b.textContent=meta.title||'App'; b.onclick=()=>{ s.classList.remove('min'); s.scrollIntoView({behavior:'smooth'}); }; dock.appendChild(b); }); }
function openApp(a){ const sid='s_'+Math.random().toString(36).slice(2); const url=a.url||'about:blank'; const card=document.createElement('div'); card.className='session'; card.dataset.sid=sid; card.dataset.meta=JSON.stringify({title:a.title||'App', url:a.url||''}); card.innerHTML=`<div class="hdr"><div class="title">${a.title||'App'}</div><div class="tools"><button class="btn" data-act="min" title="Minimizar">â€”</button><button class="btn" data-act="ref" title="Recarregar">â†»</button><button class="btn" data-act="close" title="Fechar">âœ•</button></div></div><iframe src="${url}"></iframe>`; stackWrap.prepend(card); card.querySelector('[data-act=min]').onclick=()=>{ card.classList.toggle('min'); updateDock(); }; card.querySelector('[data-act=ref]').onclick=()=>{ const fr=card.querySelector('iframe'); try{ fr.contentWindow.location.reload(); }catch{ fr.src=fr.src; } }; card.querySelector('[data-act=close]').onclick=()=>{ card.remove(); updateDock(); }; navTo('stack'); updateDock(); }

$('#btnBack').onclick=()=>{ try{ history.back(); }catch{} };
// Boot
navTo('home');
</script>
</body>
</html>
