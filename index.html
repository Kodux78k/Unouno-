<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
<title>UNO — Dual UNIFIED (mobile)</title>
<meta name="theme-color" content="#0b0f17"/>
<link rel="icon" href="assets/icons/ui/app.png"/>
<style>
:root {
  --ink:#e9f6ff; --muted:#97b1c6; --line:rgba(255,255,255,.16); --rad:18px;
  --bg:#0b0f17;
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);font:500 15px/1.35 'Montserrat',system-ui,sans-serif;overflow-x:hidden}

.app {display:grid;grid-template-rows:auto 1fr auto;min-height:100%}

/* Background */
#bg{position:fixed;inset:0;z-index:-2;background:url("assets/icons/bg/bg_nebula_01.png") center/cover no-repeat}
#bg video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;display:none}

/* HUD */
header{display:flex;justify-content:flex-end;padding:10px 12px;gap:.5rem;z-index:50}
.hud{display:flex;gap:.5rem;flex-wrap:wrap}
.badge{display:inline-flex;align-items:center;gap:.35rem;padding:.35rem .6rem;border:1px solid var(--line);border-radius:10px;background:rgba(255,255,255,.05);font-size:.78rem;color:var(--muted)}
.badge svg{width:14px;height:14px}

/* Core */
.center{display:grid;place-items:center;padding:10px}
.core{position:relative;width:min(86vw,480px);aspect-ratio:1/1;display:grid;place-items:center}
.core .ring{position:absolute;inset:0;background:url("assets/icons/core/ring_glow_01.png") center/contain no-repeat;filter:saturate(1.2)}
.core .dot{width:28px;height:28px;border-radius:50%;background:url("assets/icons/core/dot_core_01.png") center/cover no-repeat;box-shadow:0 0 28px rgba(92,255,250,.6)}
.core .controls{position:absolute;bottom:10%;display:flex;gap:12px}
.core .controls .btn{backdrop-filter:blur(8px)}

/* Buttons */
.btn{display:inline-flex;align-items:center;gap:.4rem;padding:.65rem .9rem;border-radius:14px;border:1px solid var(--line);background:rgba(255,255,255,.04);color:var(--ink);font-weight:600;cursor:pointer;transition:all .2s ease}
.btn:hover{background:rgba(255,255,255,.08)}

/* Apps panel */
.panel{margin:12px;padding:12px;border-radius:16px;background:rgba(255,255,255,.02);border:1px solid var(--line)}
.grid2{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:10px}
.apps-list{margin-top:12px;display:grid;gap:8px}
.app-row{display:flex;gap:10px;align-items:center;padding:10px;border:1px solid rgba(255,255,255,.1);border-radius:12px;background:rgba(255,255,255,.02)}
.grow{flex:1 1 auto;min-width:0}
.ellip{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-inline-size:18ch}
.meta{font-size:12px;color:var(--muted)}

/* Footer nav */
.footer{height:72px}
.footer .bar{position:fixed;left:50%;bottom:16px;transform:translateX(-50%);display:flex;gap:38px;align-items:center;padding:.75rem 1.2rem;border-radius:999px;border:1px solid var(--line);backdrop-filter:blur(12px);background:linear-gradient(90deg,rgba(255,80,240,.12),rgba(0,180,255,.12));z-index:100}
.nav-btn{appearance:none;background:none;border:0;display:grid;gap:.35rem;justify-items:center;cursor:pointer;font-size:.7rem;color:var(--muted)}
.nav-btn img{width:26px;height:26px;display:block}

/* Floating main action button */
#btnInfodose{position:fixed;bottom:90px;right:20px;width:64px;height:64px;border-radius:50%;border:1px solid var(--line);backdrop-filter:blur(8px);display:grid;place-items:center;background:linear-gradient(135deg,#00d8d8,#d800d8);box-shadow:0 8px 24px rgba(0,0,0,.35);cursor:pointer;z-index:1000}
#btnInfodose img{width:28px;height:28px}
/* ——— Button size hierarchy: 12/16/20 steps ——— */
.btn-xs{padding:.4rem .55rem;border-radius:10px;font-size:.82rem}
.btn-sm{padding:.6rem .85rem;border-radius:12px;font-size:.92rem}
.btn-md{padding:.85rem 1.15rem;border-radius:14px;font-size:1rem}
.icon-12{width:12px;height:12px}
.icon-16{width:16px;height:16px}
.icon-20{width:20px;height:20px}
/* Apply size to existing buttons */
.btn{line-height:1}
header .btn, #appsPane .btn, #packsPane .btn{ /* default */ }
/* ——— Theme tokens ——— */
html[data-theme="light"]{--bg:#f6f8fb;--ink:#0b1220;--muted:#4b5565;--line:rgba(0,0,0,.14)}
html[data-theme="light"] .footer .bar{background:linear-gradient(90deg,rgba(0,0,0,.06),rgba(0,0,0,.06))}
/* ——— FAB Mini Menu ——— */
#fabWrap{position:fixed;right:20px;bottom:160px;display:none;flex-direction:column;gap:10px;z-index:1001}
#fabWrap.show{display:flex}
.fab-item{display:flex;align-items:center;gap:.5rem;padding:.5rem .7rem;border-radius:12px;border:1px solid var(--line);background:rgba(0,0,0,.35);backdrop-filter:blur(10px)}
.fab-item img{width:18px;height:18px}
</style>
</head>
<body>
<div id="bg"><video id="bgvid" muted loop playsinline></video></div>
<div class="app">
  <header>
    <div class="hud">
      <span class="badge"><img src="assets/icons/ui/audio.svg" onerror="this.src='assets/icons/ui/audio.png'" alt="" width="14" height="14"/><button class="btn" id="btnPlay">Áudio</button></span>
      <span class="badge">FPS <b id="fps">~</b></span>
      <span class="badge">LAT <b id="lat">~</b>ms</span>
      <span class="badge">LT <b id="lt">0</b></span>
      <span class="badge">CLS <b id="cls">0.00</b></span>
    </div>
  </header>
  <main>
    <section class="center">
      <div class="core">
        <div class="ring" id="ring"></div>
        <div class="dot" id="dot"></div>
        <div class="controls">
          <button class="btn" id="ringPrev">◀︎</button>
          <button class="btn" id="ringNext">▶︎</button>
        </div>
      </div>
    </section>
    <section class="panel" id="appsPane">
      <div class="grid2">
        <button class="btn" id="btnLoadApps">Carregar apps.json</button>
        <button class="btn" id="btnExport">Exportar ZIP</button>
        <label class="btn" for="btnImportZip">Importar ZIP</label>
        <input type="file" id="btnImportZip" accept="application/zip" hidden/>
        <button class="btn" id="btnAppsToggle">Apps</button>
        <button class="btn" id="btnToggleAnim">Animação</button>
        <label class="btn" for="ringUpload">Upload Ring</label>
        <input type="file" id="ringUpload" accept="image/png" hidden />
        <label class="btn" for="bgUpload">Upload Fundo</label>
        <input type="file" id="bgUpload" accept="image/png,image/gif,video/webm,video/mp4" hidden />
      </div>
      <div class="apps-list" id="appsList"></div>
    </section>
    <!-- Packs Panel (localStorage; sem indexedDB) -->
    <section class="panel" id="packsPane">
      <div class="grid2 packs-controls">
        <input type="file" id="fileImport" accept="application/json,audio/*" multiple hidden/>
        <label class="btn" for="fileImport">Importar Packs</label>
        <button class="btn" id="btnExportPacks">Exportar JSON</button>
        <button class="btn" id="btnClearPacks">Limpar</button>
      </div>
      <div class="apps-list" id="packsList"></div>
    </section>
  </main>
  <footer class="footer">
  <div class="bar">
    <button class="nav-btn" title="Início" id="navHome">
      <img src="assets/icons/ui/home.svg" onerror="this.src='assets/icons/ui/home.png'" alt="Início"/>
      <span>Início</span>
    </button>
    <button class="nav-btn" title="Apps" id="navApps">
      <img src="assets/icons/ui/grid.svg" onerror="this.src='assets/icons/ui/grid.png'" alt="Apps"/>
      <span>Apps</span>
    </button>
    <button class="nav-btn" title="Packs" id="navPacks">
      <img src="assets/icons/ui/layers.svg" onerror="this.src='assets/icons/ui/layers.png'" alt="Packs"/>
      <span>Packs</span>
    </button>
    <button class="nav-btn" title="Perfil" id="navUser">
      <img src="assets/icons/ui/user.svg" onerror="this.src='assets/icons/ui/user.png'" alt="Perfil"/>
      <span>Perfil</span>
    </button>
  </div>
</footer>
  <button id="btnInfodose" title="Ação Rápida"><img src="assets/icons/ui/bolt.svg" onerror="this.src='assets/icons/ui/bolt.png'" alt=""/></button>
<!-- Mini Menu (centraliza ações extras) -->
<div id="fabWrap" aria-label="Menu rápido">
  <button class="fab-item" id="mnuAppsJson"><img src="assets/icons/ui/json.svg" onerror="this.src='assets/icons/ui/json.png'" alt=""/> Carregar apps.json</button>
  <button class="fab-item" id="mnuRingUp"><img src="assets/icons/ui/upload.svg" onerror="this.src='assets/icons/ui/upload.png'" alt=""/> Upload Ring</button>
  <button class="fab-item" id="mnuBgUp"><img src="assets/icons/ui/image.svg" onerror="this.src='assets/icons/ui/image.png'" alt=""/> Upload Fundo</button>
  <button class="fab-item" id="mnuAnim"><img src="assets/icons/ui/bolt.svg" onerror="this.src='assets/icons/ui/bolt.png'" alt=""/> Alternar animação</button>
  <hr style="opacity:.25;border:0;border-top:1px solid var(--line)">
  <button class="fab-item" id="mnuPacksImport"><img src="assets/icons/ui/layers.svg" onerror="this.src='assets/icons/ui/layers.png'" alt=""/> Importar Packs</button>
  <button class="fab-item" id="mnuPacksExport"><img src="assets/icons/ui/download.svg" onerror="this.src='assets/icons/ui/download.png'" alt=""/> Exportar Packs</button>
  <button class="fab-item" id="mnuPacksClear"><img src="assets/icons/ui/trash.svg" onerror="this.src='assets/icons/ui/trash.png'" alt=""/> Limpar Packs</button>
  <hr style="opacity:.25;border:0;border-top:1px solid var(--line)">
  <button class="fab-item" id="mnuTheme"><img id="icoTheme" src="assets/icons/ui/sun.svg" onerror="this.src='assets/icons/ui/sun.png'" alt=""/> Alternar tema</button>
</div>
</div>
<script>
const rings=["assets/icons/core/ring_glow_01.png","assets/icons/core/ring_glow_02.png","assets/icons/core/ring_glow_03.png","assets/icons/core/ring_glow_04.png"];
let rIndex=0;const ringEl=document.getElementById('ring');
function setRing(i){rIndex=(i+rings.length)%rings.length;ringEl.style.backgroundImage=`url(${rings[rIndex]})`;}
setRing(0);
document.getElementById('ringPrev').onclick=()=>setRing(rIndex-1);
document.getElementById('ringNext').onclick=()=>setRing(rIndex+1);

let anim=true,ang=0;function animLoop(){if(!anim)return;ang+=0.4;ringEl.style.transform=`rotate(${ang}deg)`;requestAnimationFrame(animLoop);}animLoop();
document.getElementById('btnToggleAnim').onclick=()=>{anim=!anim;if(anim)animLoop();else ringEl.style.transform='';};

// FAB toggle opens mini menu
const $fab=document.getElementById('btnInfodose');
const $fabWrap=document.getElementById('fabWrap');
$fab.onclick=()=>{ $fabWrap.classList.toggle('show'); };

// Wire mini menu to existing actions
const click=(sel)=>document.querySelector(sel)?.click();
document.getElementById('mnuAppsJson').onclick=()=> click('#btnLoadApps');
document.getElementById('mnuRingUp').onclick=()=> click('#ringUpload');
document.getElementById('mnuBgUp').onclick=()=> click('#bgUpload');
document.getElementById('mnuAnim').onclick=()=> click('#btnToggleAnim');
document.getElementById('mnuPacksImport').onclick=()=> click('#fileImport');
document.getElementById('mnuPacksExport').onclick=()=> click('#btnExportPacks');
document.getElementById('mnuPacksClear').onclick=()=> click('#btnClearPacks');

// Theme toggle (svg/png dinâmico)
(function(){
  const html=document.documentElement, ico=document.getElementById('icoTheme');
  const cycle=['dark','light'];
  function apply(theme){ html.setAttribute('data-theme', theme==='dark'?'' : theme); if(theme==='light'){ ico.src='assets/icons/ui/moon.svg'; ico.onerror=()=>{ico.src='assets/icons/ui/moon.png'}; } else { ico.src='assets/icons/ui/sun.svg'; ico.onerror=()=>{ico.src='assets/icons/ui/sun.png'}; } localStorage.setItem('dual.theme', theme); }
  const current=localStorage.getItem('dual.theme')||'dark'; apply(current);
  document.getElementById('mnuTheme').onclick=()=>{ const t=localStorage.getItem('dual.theme')||'dark'; apply(t==='dark'?'light':'dark'); };
})();
// === Packs: localStorage; com ícone Packs no footer ===
(function(){
  const K='dualUno.packs', $=s=>document.querySelector(s);
  const read=()=>{ try{return JSON.parse(localStorage.getItem(K)||'[]')}catch(e){return[]} };
  const write=(arr)=>{ try{localStorage.setItem(K, JSON.stringify(arr))}catch(e){console.warn('ls write fail',e)} };
  function render(){ const list=$('#packsList'); if(!list) return; const packs=read(); if(!packs.length){ list.innerHTML='<em>Nenhum pack.</em>'; return; } list.innerHTML=''; packs.forEach((p,i)=>{ const row=document.createElement('div'); row.className='app-row'; row.innerHTML=`<span class="badge">#${i+1}</span><div class="grow"><div><strong class="ellip" title="${p.name||p.id}">${p.name||p.id}</strong></div><div class="meta">${p.type}</div></div><button class="btn" data-play="${i}">▶︎</button>`; list.appendChild(row); }); list.onclick=(e)=>{ const i=e.target?.dataset?.play; if(i!=null){ alert('Reproduzir (mock) '+(read()[i]?.name||'pack')); } } }
  const fi=$('#fileImport'); if(fi){ fi.addEventListener('change', async (e)=>{ const files=[...(e.target.files||[])]; if(!files.length) return; const packs=read(); for(const f of files){ try{ if((f.type||'').startsWith('audio/')){ const arr=await f.arrayBuffer(); const b64=btoa(String.fromCharCode(...new Uint8Array(arr))); packs.push({id:`audio:${f.name}`, name:f.name, type:f.type||'audio', data:b64}); } else { const txt=await f.text(); const json=JSON.parse(txt); packs.push({id:`json:${f.name}`, name:f.name, type:'application/json', data:json}); } }catch(err){ console.warn('import err', err); } } write(packs); render(); }); }
  const bx=$('#btnExportPacks'); if(bx){ bx.onclick=()=>{ const blob=new Blob([JSON.stringify(read(),null,2)],{type:'application/json'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='dual_packs_export.json'; a.click(); } }
  const bc=$('#btnClearPacks'); if(bc){ bc.onclick=()=>{ write([]); render(); } }
  const np=document.getElementById('navPacks'); if(np){ np.onclick=()=> document.getElementById('packsPane').scrollIntoView({behavior:'smooth'}); }
  render();
})();
</script>
</body>
</html>
